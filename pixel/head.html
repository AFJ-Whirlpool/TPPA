<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="{{settings.idOneTrust}}"></script>
<script type="text/javascript">
  if ('{{settings.activeOneTrust}}' == 'true') {
    function OptanonWrapper() {}
    console.log('OneTrust Cookie Management Loaded');
  }
</script>

<script async src="https://www.googletagmanager.com/gtag/js?id={{settings.ga4Id}}"></script>
<script>
  var ga4Id = '{{settings.ga4Id}}'
  var ga4IdDebug = '{{settings.debug}}' == 'true' ? true : false
  var ga4Options = {
    
  }

  if ('{{settings.debug}}' == 'true') {
    ga4Options.debug_mode = true
  }

  if (ga4Id) {
    window.localStorage.setItem('ga4Vtex', ga4Id)
    window.localStorage.setItem('ga4Vtex_debug', ga4IdDebug)
    window.dataLayer = window.dataLayer || []
    function gtag() {
      window.dataLayer.push(arguments)
    }
    gtag('js', new Date())

    gtag('config', ga4Id, ga4Options)
    console.log('Google Analytics 4 Loaded');
  } else {
    console.error(
      'Warning: No Google Analytics ID is defined. Please configure it in the apps admin.'
    )
  }
</script>

<script>
  var srcLytics = 'https://c.lytics.io/api/tag/{{settings.srcLytics}}/latest.min.js'
  var streamLytics = '{{settings.streamLytics}}'
  var activeLytics = '{{settings.activeLytics}}' === 'true' ? true : false
  window.localStorage.setItem('srcLytics', srcLytics)
  window.localStorage.setItem('streamLytics', streamLytics)
  window.localStorage.setItem('activeLytics', activeLytics)

  if (activeLytics === true && srcLytics) {
    window.dataLayer = window.dataLayer || []
    function jstag() {
      window.dataLayer.push(arguments)
    }
    jstag('js', new Date())

    jstag(streamLytics, srcLytics, activeLytics)
    console.log('Lytics Loaded');
  } else {
    console.error(
      'Warning: No Lytics src is defined. Please configure it in the apps admin.'
    )
  }
</script>

<script type="text/javascript">
  !(function () {
    'use strict'
    var o = window.jstag || (window.jstag = {}),
      r = []
    function n(e) {
      o[e] = function () {
        for (var n = arguments.length, t = new Array(n), i = 0; i < n; i++)
          t[i] = arguments[i]
        r.push([e, t])
      }
    }
    n('send'),
      n('mock'),
      n('identify'),
      n('pageView'),
      n('unblock'),
      n('getid'),
      n('setid'),
      n('loadEntity'),
      n('getEntity'),
      n('on'),
      n('once'),
      n('call'),
      (o.loadScript = function (n, t, i) {
        var e = document.createElement('script')
        ;(e.async = !0), (e.src = n), (e.onload = t), (e.onerror = i)
        var o = document.getElementsByTagName('script')[0],
          r = (o && o.parentNode) || document.head || document.body,
          c = o || r.lastChild
        return null != c ? r.insertBefore(e, c) : r.appendChild(e), this
      }),
      (o.init = function n(t) {
        return (
          (this.config = t),
          this.loadScript(t.src, function () {
            if (o.init === n) throw new Error('Load error!')
            o.init(o.config),
              (function () {
                for (var n = 0; n < r.length; n++) {
                  var t = r[n][0],
                    i = r[n][1]
                  o[t].apply(o, i)
                }
                r = void 0
              })()
          }),
          this
        )
      })
  })()

  jstag.init({
    src: 'https://c.lytics.io/api/tag/{{settings.srcLytics}}/latest.min.js',
    pageAnalysis: {
      dataLayerPull: {
        disabled: true,
      },
    },
  })

  jstag.pageView()
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','{{settings.gTagManId}}');</script>
<script type="text/javascript">
  console.log('Google Tag Manager Loaded');
</script>
  <!-- End Google Tag Manager -->